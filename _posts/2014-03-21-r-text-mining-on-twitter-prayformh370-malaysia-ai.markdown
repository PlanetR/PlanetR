---
title: "R: Text Mining on Twitter #PrayForMH370 Malaysia Airlines"
kind: article
created_at: 2014-03-21 07:50:00 UTC
author: Alstatr
categories: 
tags: 
layout: post
---
<div dir="ltr" style="text-align: left;" trbidi="on">It's been two weeks for search and rescue operations of the Malaysia Airlines Flight MH370, after it vanished from the radar on March 8, 2014. And wherever they are, we hope and pray for them.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-38t-DCc6MBI/UypHVfn-mxI/AAAAAAAABnE/fm7H3QP-rps/s1600/Wall-Of-Hope-Prayers-MH370-1-Utama.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-38t-DCc6MBI/UypHVfn-mxI/AAAAAAAABnE/fm7H3QP-rps/s1600/Wall-Of-Hope-Prayers-MH370-1-Utama.jpg" height="263" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Photo from <a href="http://www.venusbuzz.com/archives/64945/wall-hope-prayers-mh370/" target="_blank">VENUS - Wall of Hope &amp; Prayers for MH370</a></td></tr></tbody></table><br />In this post, we are going to do text data mining on Twitter tweets  containing #PrayForMH370 from March 8, to March 20, 2014 using Twitter API. First, we need to have an authentication on the Twitter API, to obtain the data. In the proceeding tutorial, the idea and codes for Twitter authentication were based from <a href="http://thinktostart.wordpress.com/2013/05/22/twitter-authentification-with-r/" target="_blank">Julianhi's amazing blog</a>, and I am going to replicate his code to save a copy of it.<br /><a name='more'></a><br />Go to <a href="https://dev.twitter.com/">https://dev.twitter.com/</a>, and sign in with your twitter account. When you're done, click on your profile picture on the top right corner like the one below.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Yf5961-Rfy0/UypWpMilSNI/AAAAAAAABnU/OlkD1-VxBNU/s1600/Screenshot+from+2014-03-20+10:44:01.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-Yf5961-Rfy0/UypWpMilSNI/AAAAAAAABnU/OlkD1-VxBNU/s1600/Screenshot+from+2014-03-20+10:44:01.png" /></a></div><br /><br />Click on <b>My applications</b>, then <b>Create New App</b>. Fill in what's necessary (i.e. Name, Description and Website).<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-QwGOjvMN92E/UypbPyyd-pI/AAAAAAAABn4/Njd2wwCBVUs/s1600/Screenshot+from+2014-03-20+11:05:25.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-QwGOjvMN92E/UypbPyyd-pI/AAAAAAAABn4/Njd2wwCBVUs/s1600/Screenshot+from+2014-03-20+11:05:25.png" height="397" width="400" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><a href="http://thinktostart.wordpress.com/2013/05/22/twitter-authentification-with-r/" target="_blank">Julianhi</a> recommends <a href="http://test.de/">http://test.de/</a> for valid Website, and name it anything you want (same case for description). To finish this, check <b>Yes, I agree</b> on <span class="fieldset-legend">Developer Rules of the Road, and click on <b>Create your Twitter application</b>. You will have something like this,</span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-G7BKdi4jp1A/UypgcWp-ohI/AAAAAAAABoI/hkGeO5R-OH0/s1600/Screenshot+from+2014-03-20+11:27:40.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-G7BKdi4jp1A/UypgcWp-ohI/AAAAAAAABoI/hkGeO5R-OH0/s1600/Screenshot+from+2014-03-20+11:27:40.png" height="210" width="400" /></a></div><br />Keep this open on your browser, and go to your R script. Copy and paste the following code, <br /><br /><script src="https://gist.github.com/alstat/9656597.js"></script>Replace the <code>apiKey</code> and <code>apiSecret</code> with the one on the API Keys tab of your Twitter app (see above photo -- refer back to your browser), then run the above code. If you encounter error that says <error>Error: Unauthorized</error>, make sure to remove the spaces (if any) both at the end of your <code>apiKey</code> or <code>apiSecret</code> between the quotations, i.e.<br /><br /><script src="https://gist.github.com/alstat/9656697.js"></script>This happens especially when you do copy and paste (I'm guilty of that). But if there is no error, <code>twitCred$handshake</code> will return a link. Copy and paste this link to your browser, then authorize the app,<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-FpDODryf-do/UyplZQtWMUI/AAAAAAAABoY/vGgucFREErk/s1600/Screenshot+from+2014-03-20+11:48:56.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-FpDODryf-do/UyplZQtWMUI/AAAAAAAABoY/vGgucFREErk/s1600/Screenshot+from+2014-03-20+11:48:56.png" height="281" width="400" /></a></div><br />After clicking <b>Authorize app</b>, take note of the PIN and enter it to the R Console; finally, run the last function (line 24 above). Now that we have an access, we can extract data then. For this post, we will make a word cloud for #PrayforMH370 and #MH370 (bonus) on the said inclusive dates. Here it is, run the following:<br /><br /><script src="https://gist.github.com/alstat/9657434.js"></script>The above code for creating word cloud is originally from <a href="https://sites.google.com/site/miningtwitter/questions/talking-about/wordclouds/wordcloud1" target="_blank">Mining twitter with R</a> site, and below is the output of that, <br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-QmYNlRATkQQ/UypwJTC1gpI/AAAAAAAABow/gSdHgCOZNAY/s1600/Rplot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-QmYNlRATkQQ/UypwJTC1gpI/AAAAAAAABow/gSdHgCOZNAY/s1600/Rplot.png" /></a></div>If you notice in the code, line 6 above, I set n = 1000. This line will likely to give you a warning that says,<br /><br /><script src="https://gist.github.com/alstat/9657626.js"></script>Just ignore this, as this simply mean that there are only 599 tweets in total that use #PrayforMH370 during the inclusive dates. Now, let's investigate the above word cloud. I know very little about Bahasa Melayu (Malay Language), but I can tell the words in high scale are likely to be Malay prepositions, or in computing term, Malay <a href="http://en.wikipedia.org/wiki/Stop_words" target="_blank">stop words</a>. This is because we exclude Malay stop words (only <code>'prayformh370'</code>, <code>'prayformh'</code> and <code>stopwords('english')</code> -- English stop words) in the code as it is not yet supported by the <a href="http://www.inside-r.org/packages/cran/tm/docs/stopwords" target="_blank"><code>stopwords</code></a> function. Hence, not a good word cloud for tweets exploratory. So I look for a list of Malay stop words on the web, and led me to this <a href="http://blog.kerul.net/2014/01/list-of-malay-stop-words.html" target="_blank">site</a>. Since this is what we are looking for, thus we import the list using the <a href="http://cran.r-project.org/web/packages/XML/index.html" target="_blank">XML</a> package.<br /><br /><script src="https://gist.github.com/alstat/9657529.js"></script>Supplying the previous code with the Malay stopwords, thus we have<br /><br /><script src="https://gist.github.com/alstat/9657568.js"></script> <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-rF7dFIEHhaE/Uyp1_JdgMEI/AAAAAAAABpA/vqGpeUbbuws/s1600/WordCloud2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-rF7dFIEHhaE/Uyp1_JdgMEI/AAAAAAAABpA/vqGpeUbbuws/s1600/WordCloud2.png" /></a></div>There is the difference, <i>dengannya</i>, <i>telah</i> and <i>bagi</i> were actually stop words. And base from this multilingual guy (Google Translate), the <i>"waktu solat masuk</i><i>"</i> means <i><i>"</i>prayer time in</i><i>"</i>. You can play with the words above. For #MH370, using the same codes with Malay and all available stop words from <code>stopwords</code> function, we have<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-VsIC0lZK4Gk/Uyp89vhTGzI/AAAAAAAABpY/F_DZx8xSLjA/s1600/WordCloud3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-VsIC0lZK4Gk/Uyp89vhTGzI/AAAAAAAABpY/F_DZx8xSLjA/s1600/WordCloud3.png" /></a></div><br />And why is it in square? and not circle? Well that is due to the small screen I have and large number of dataset (1000 data points). So, from the two plots we have (#PrayForMH370 and #MH370), we can say subjectively, that tweets under #MH370 were mostly, maybe, retweets of media tweets since there are words like <i>cnn</i>, <i>malaysia</i>, with link like <i>httpcodjczaqtm</i>. There is also name of the CNN anchor <i>andersoncooper</i>. Another <i>sobrevolando</i> (spanish for <i>flying over</i>, Google knows it well). We can also see the word <i>probably</i>, since there are many guesses as to what happen when this news came out. And of course, most Twitter users from Malaysia during the inclusive dates (March 8 to  20), were expressing their prayers on the lost plane. That's what I see, what about your exploration?</div><center><br/><input onclick="window.open('https://github.com/alstat/Analysis-with-Programming/blob/master/2014/R/Text-Mining-on-Twitter-PrayForMH370-Malaysia-Airlines/Source.pdf?raw=true', '_blank')" type="button" value="Download PDF Version" /></center><div class="author">
  <img src="" style="width: 96px; height: 96;">
  <span style="position: absolute; padding: 32px 15px;">
    <i>Original post by <a href="http://twitter.com/">Alstatr</a> - check out <a href="http://alstatr.blogspot.com/">Analysis with Programming</a></i>
  </span>
</div>
