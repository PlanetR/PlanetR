---
title: "R: Fun with surf3D function"
kind: article
created_at: 2014-02-19 13:37:00 UTC
author: Alstatr
categories: 
tags: 
layout: post
---
<div dir="ltr" style="text-align: left;" trbidi="on">There is one package that I've been longing. A package that will give me the power to manipulate and do any 3D stuffs in R. I tried <code><a href="http://stat.ethz.ch/R-manual/R-patched/library/graphics/html/persp.html">persp</a></code> and <code><a href="https://stat.ethz.ch/R-manual/R-devel/library/lattice/html/cloud.html">wireframe</a></code>, but I find them difficult to use especially on complicated mathematical functions, like doing parametric plots. And I am just frustrated about that, since I envy the 3D graphics of <a href="http://www.wolfram.com/mathematica/" target="_blank">Wolfram Mathematica</a> a lot, which I exploited for about a year, before I embrace R. However, that has come to an end after <i>Joseph Rickert </i> introduced the <a href="http://cran.r-project.org/web/packages/plot3D/index.html" target="_blank">plot3D</a> (authored by <i>Karline Soetaert</i>) package in his <a href="http://blog.revolutionanalytics.com/2014/02/3d-plots-in-r.html" target="_blank">post</a>. And for the moment, we will be playing with the <code>surf3D</code> function. Here is the first one, the Mollusc Shell surface plot:<br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-fqcUaS7Gvpg/UwMqZ0OYQjI/AAAAAAAABcQ/mggc_zUI1cg/s1600/animation2.gif" /></div>With parametric equations:<br />$$<br />&nbsp;\begin{eqnarray}<br />x(u,v)&amp;=&amp;\left(1.16^v\right)(1 + \cos(u))\cos(v);\nonumber\\<br />y(u,v)&amp;=&amp;\left(-1.16^v\right)(1 + \cos(u))\sin(v);\nonumber\\<br />z(u,v)&amp;=&amp;\left(-2\times 1.16^v\right)(1 + \sin(u));\nonumber <br />\end{eqnarray} <br />$$where $u\in[0, 2\pi],\,v\in[-15, 6]$. By the way, I am not sure if that's the general equations of the Mollusc shell, I can't find one on the web. In case you know it, please inform me by commenting below. The above equations was based from the <a href="http://reference.wolfram.com/mathematica/ref/ParametricPlot3D.html">Mathematica Documentation</a>, with code<br /><br /><script src="https://gist.github.com/alstat/9084679.js"></script>Now with extra animation, here is the R equivalent:<br /><br /><script src="https://gist.github.com/alstat/9070907.js"></script> <br /><a name='more'></a>Next is the "figure 8" immersion (Klein bagel) of the Klein bottle:<br />$$<br />\begin{eqnarray} <br />x(u,v)&amp;=&amp;\left[a+\cos\left(\displaystyle\frac{1}{2}\right)\sin(v)-\sin\left(\displaystyle\frac{1}{2}\right)\sin(2v)\right]\cos(u);\nonumber\\<br />y(u,v)&amp;=&amp;\left[a+\cos\left(\displaystyle\frac{1}{2}\right)\sin(v)-\sin\left(\displaystyle\frac{1}{2}\right)\sin(2v)\right]\sin(u);\nonumber\\<br />z(u,v) &amp;=&amp;\sin\left(\displaystyle\frac{1}{2}u\right)\sin(v) + \cos\left(\displaystyle\frac{1}{2}u\right)\sin(2v).\nonumber<br />\end{eqnarray}<br />$$For $u\in [0,2\pi),\,v\in[0,2\pi),$ and $a&gt;2$.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-yv2j-92hltE/UwMqY_1oU3I/AAAAAAAABcM/5nOsu2y2ksg/s1600/animation1.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-yv2j-92hltE/UwMqY_1oU3I/AAAAAAAABcM/5nOsu2y2ksg/s1600/animation1.gif" /></a></div>Which in R,<br /><br /><script src="https://gist.github.com/alstat/9071176.js"></script>Now let's investigate the script of this static, transparent Mollusc Shell:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-nsHHQNKKH4o/UwRuY2C0X6I/AAAAAAAABcw/n33WyKkeruI/s1600/Rplot05.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-nsHHQNKKH4o/UwRuY2C0X6I/AAAAAAAABcw/n33WyKkeruI/s1600/Rplot05.png" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br /><script src="https://gist.github.com/alstat/9088320.js"></script> <br /><ol style="text-align: left;"><li>Call the package, that's obviously the first line; </li><li>Line 3 to 7 basically assigns the ranges of $u$ and $v$ variables;</li><li>Line 10 to 12 are the parametric equations of the shape;</li><li>Line 15 adjusts the margin of the plot on all sides in inches; and finally</li><li>Line 16 to 20 generates the plot.</li></ol>I will end this post with a quote from my favourite TV show, <a href="http://www.imdb.com/title/tt0433309/" target="_blank">Numb3rs</a>:<br /><br /><blockquote class="tr_bq">Math is nature's language, it's method of communicating directly with us. So everything is Numbers. ~ <i>Charlie Eppes from <a href="http://www.youtube.com/watch?v=vFRTgr7MfWw" target="_blank">Numb3rs - Sabotage, Season I</a>.</i></blockquote><br /><h3 style="text-align: left;">References:&nbsp;</h3><ol style="text-align: left;"><li><a href="http://en.wikipedia.org/wiki/Klein_bottle" target="_blank">Klein Bottle - </a><i><a href="http://en.wikipedia.org/wiki/Klein_bottle" target="_blank">Wikipedia</a>.</i> Retrieved February 18, 2014.</li><li><div class="small"><a href="http://mathworld.wolfram.com/about/author.html">Weisstein, Eric W.</a> "Klein Bottle." From <a href="http://mathworld.wolfram.com/"><i>MathWorld</i></a>--A Wolfram Web Resource. <a href="http://mathworld.wolfram.com/KleinBottle.html">http://mathworld.wolfram.com/KleinBottle.html</a></div></li></ol></div><div class="author">
  <img src="" style="width: 96px; height: 96;">
  <span style="position: absolute; padding: 32px 15px;">
    <i>Original post by <a href="http://twitter.com/">Alstatr</a> - check out <a href="http://alstatr.blogspot.com/">Analysis with Programming</a></i>
  </span>
</div>
